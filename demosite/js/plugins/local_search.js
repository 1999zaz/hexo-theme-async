(()=>{var w=(()=>{let e=null;return()=>{if(!!LocalSearch){if(!e){let{search:c,root:u}=window.ASYNC_CONFIG;e=new LocalSearch({path:u+c.path,top_n_per_article:c.top_n_per_article,unescape:c.unescape})}return e}}})();function f(){let{search:e,i18n:c}=window.ASYNC_CONFIG;if(e.enable&&e.type==="local"){if(!e.path){console.warn("`hexo-generator-searchdb` plugin is not installed!");return}let u=document.querySelector("#trm-search-btn"),d=document.querySelector(".trm-search-popup-btn-close"),s=document.querySelector(".trm-search-input"),r=w();e.preload&&!r.isfetched&&r.fetchData();let a=()=>{if(!r.isfetched)return;let t=s.value.trim().toLowerCase(),L=t.split(/[-\s]+/),v=document.querySelector(".trm-search-result-container"),o=[];if(t.length>0&&(o=r.getResultItems(L)),o.length>0){o.sort((n,i)=>n.includedCount!==i.includedCount?i.includedCount-n.includedCount:n.hitCount!==i.hitCount?i.hitCount-n.hitCount:i.id-n.id);let l=c.hits.replace(/\$\{hits}/,o.length);v.innerHTML=`
            <div class="search-stats">${l}</div>
            <ul class="search-result-list">${o.map(n=>n.item).join("")}</ul>`}else{let l=c.empty.replace(/\$\{query}/,t);v.innerHTML=`<div class="search-stats">${l}</div>`}},p=()=>{document.querySelector(".trm-search-popup").classList.toggle("show"),setTimeout(()=>s.focus(),500),r.isfetched||r.fetchData()},h=function(t){document.querySelector(".trm-search-popup").classList.toggle("show")},m=function(t){t.key==="Enter"&&a()};e.trigger==="auto"?s.addEventListener("input",a):s.addEventListener("keypress",m),d.addEventListener("click",h),u.addEventListener("click",p),document.addEventListener("swup:contentReplaced",t=>{u.removeEventListener("click",p),d.removeEventListener("click",h),s.removeEventListener("input",a),s.removeEventListener("keypress",m)})}}f();window.ASYNC_CONFIG.swup&&document.addEventListener("swup:contentReplaced",function(){f()});})();
